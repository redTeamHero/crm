{
  "BALANCE_GT_CL": {
    "violation": "Balance exceeds Credit Limit",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "critical",
    "fieldsImpacted": ["balance","credit_limit"],
    "rule": {
      "all": [
        {"field":"account_type","eq":"Revolving"},
        {"field":"balance","gt_field":"credit_limit"}
      ]
    }
  },

  "PASTDUE_GT_BALANCE": {
    "violation": "Past Due exceeds balance",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["past_due","balance"],
    "rule": {
      "all": [
        {"field":"past_due","gt_field":"balance"}
      ]
    }
  },

  "PASTDUE_WITH_ZERO_BALANCE": {
    "violation": "Past Due > 0 while Balance = 0",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["past_due","balance"],
    "rule": {
      "all": [
        {"field":"balance","eq":0},
        {"field":"past_due","gt":0}
      ]
    }
  },

  "NEGATIVE_BALANCE": {
    "violation": "Balance is negative",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["balance"],
    "rule": {
      "all": [
        {"field":"balance","lt":0}
      ]
    }
  },

  "HIGH_CREDIT_LT_BALANCE": {
    "violation": "High Credit is less than Balance",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["high_credit","balance"],
    "rule": {
      "all": [
        {"field":"high_credit","lt_field":"balance"}
      ]
    }
  },

  "UTILIZATION_SPIKE_XB": {
    "violation": "Utilization spike during XB/XF dispute period",
    "target": "tradeline",
    "fcraSection": "§611(a)",
    "severity": "moderate",
    "fieldsImpacted": ["balance","credit_limit","compliance_code"],
    "rule": {
      "all": [
        {"field":"account_type","eq":"Revolving"},
        {"field":"compliance_code","in":["XB","XF"]},
        {"expr":"balance / credit_limit","gt":0.5}
      ]
    }
  },

  "OPEN_REVOLVING_ZERO_LIMIT": {
    "violation": "Open revolving account has a zero credit limit",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["account_status","credit_limit"],
    "rule": {
      "all": [
        {"field":"account_type","eq":"Revolving"},
        {"field":"account_status","eq":"Open"},
        {"field":"credit_limit","eq":0}
      ]
    }
  },

  "OPEN_INSTALLMENT_ZERO_PAYMENT": {
    "violation": "Open installment account has 0 monthly payment",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["account_status","monthly_payment"],
    "rule": {
      "all": [
        {"field":"account_type","eq":"Installment"},
        {"field":"account_status","eq":"Open"},
        {"field":"monthly_payment","eq":0}
      ]
    }
  },

  "ZERO_BAL_WITH_PAYMENT_DUE": {
    "violation": "Zero balance but scheduled payment due",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["balance","scheduled_payment_amount"],
    "rule": {
      "all": [
        {"field":"balance","eq":0},
        {"field":"scheduled_payment_amount","gt":0}
      ]
    }
  },

  "BALANCE_UP_AFTER_CHARGEOFF": {
    "violation": "Balance increased after Chargeoff",
    "target": "tradeline",
    "fcraSection": "§623(a)(5)",
    "severity": "critical",
    "fieldsImpacted": ["balance","historical_balance"],
    "rule": {
      "all": [
        {"field":"account_status","eq":"Charge-off"},
        {"field":"balance","gt_field":"history[*].fields.balance"} 
      ]
    }
  },

  "BALANCE_CHANGED_POST_CLOSE": {
    "violation": "Balance changed after closure date",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "major",
    "fieldsImpacted": ["balance","date_closed","history"],
    "rule": {
      "all": [
        {"field":"account_status","eq":"Closed"},
        {"field":"balance","neq_field":"history[*].fields.balance"}
      ]
    }
  },

  "CREDIT_LIMIT_FLUCTUATION": {
    "violation": "Credit limit changed without notation",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["credit_limit","history"],
    "rule": {
      "all": [
        {"field":"account_type","eq":"Revolving"},
        {"field":"credit_limit","neq_field":"history[*].fields.credit_limit"}
      ]
    }
  },

  "UTILIZATION_INCONSISTENT_WITH_BALANCE": {
    "violation": "Reported utilization inconsistent with balance/limit",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["balance","credit_limit","reported_utilization"],
    "rule": {
      "all": [
        {"expr":"(balance / credit_limit) * 100","neq_field":"reported_utilization"}
      ]
    }
  },

  "INSTALLMENT_BALANCE_GT_ORIGINAL": {
    "violation": "Installment balance greater than original loan amount",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["balance","original_amount"],
    "rule": {
      "all": [
        {"field":"account_type","eq":"Installment"},
        {"field":"balance","gt_field":"original_amount"}
      ]
    }
  },

  "BALANCE_PRESENT_ON_PAID_ACCOUNT": {
    "violation": "Account marked paid but still shows a balance",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "major",
    "fieldsImpacted": ["account_status","balance"],
    "rule": {
      "all": [
        {"field":"account_status","in":["Paid","Paid in Full","Settled"]},
        {"field":"balance","gt":0}
      ]
    }
  },


  "LAST_REPORTED_STALE_ACTIVE": {
    "violation": "Active account not updated in over 90 days",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["last_reported","account_status"],
    "rule": {
      "all": [
        {"field":"account_status","in":["Open","Current","Pays as Agreed"]},
        {"field":"last_reported","gt":"90"} 
      ]
    }
  },

  "LAST_REPORTED_BEFORE_OPEN_DATE": {
    "violation": "Last Reported date occurs before Date Opened",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["last_reported","date_opened"],
    "rule": {
      "all": [
        {"field":"last_reported","lt_field":"date_opened"}
      ]
    }
  },

  "DOLP_BEFORE_OPEN_DATE": {
    "violation": "Date of Last Payment occurs before Date Opened",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "major",
    "fieldsImpacted": ["date_last_payment","date_opened"],
    "rule": {
      "all": [
        {"field":"date_last_payment","lt_field":"date_opened"}
      ]
    }
  },

  "PAYMENT_AFTER_CLOSURE": {
    "violation": "Account shows payment after being closed",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "major",
    "fieldsImpacted": ["date_last_payment","date_closed"],
    "rule": {
      "all": [
        {"field":"date_closed","exists":true},
        {"field":"date_last_payment","gt_field":"date_closed"}
      ]
    }
  },

  "CLOSED_ACCOUNT_STILL_REPORTING": {
    "violation": "Closed account still reporting monthly activity",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["account_status","last_reported"],
    "rule": {
      "all": [
        {"field":"account_status","eq":"Closed"},
        {"field":"last_reported","gt":"90"}
      ]
    }
  },

  "REPORTING_AFTER_ZERO_BAL_CLOSED": {
    "violation": "Closed zero-balance account still reporting monthly",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["balance","account_status","last_reported"],
    "rule": {
      "all": [
        {"field":"balance","eq":0},
        {"field":"account_status","eq":"Closed"},
        {"field":"last_reported","gt":"90"}
      ]
    }
  },

  "DOLP_MOVED_FORWARD": {
    "violation": "Re-aging: DOFD moved forward compared to history",
    "target": "tradeline",
    "fcraSection": "§623(a)(5)",
    "severity": "critical",
    "fieldsImpacted": ["dofd","history"],
    "rule": {
      "all": [
        {"field":"dofd","gt_field":"history[*].fields.dofd"}
      ]
    }
  },

  "DOFD_MISSING_ON_DEROG": {
    "violation": "DOFD missing on derogatory tradeline",
    "target": "tradeline",
    "fcraSection": "§623(a)(5)",
    "severity": "major",
    "fieldsImpacted": ["dofd","payment_status"],
    "rule": {
      "all": [
        {"field":"payment_status","in":["30","60","90","120","180","CO","Collection"]},
        {"field":"dofd","exists":false}
      ]
    }
  },

  "DATE_CLOSED_BEFORE_OPEN_DATE": {
    "violation": "Date Closed occurs before Date Opened",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "major",
    "fieldsImpacted": ["date_closed","date_opened"],
    "rule": {
      "all": [
        {"field":"date_closed","lt_field":"date_opened"}
      ]
    }
  },

  "CHARGEOFF_DATE_BEFORE_DELINQUENCY": {
    "violation": "Chargeoff date occurs before DOFD",
    "target": "tradeline",
    "fcraSection": "§623(a)(5)",
    "severity": "critical",
    "fieldsImpacted": ["date_chargeoff","dofd"],
    "rule": {
      "all": [
        {"field":"date_chargeoff","lt_field":"dofd"}
      ]
    }
  },

  "DOLP_EQUALS_OPEN_DATE": {
    "violation": "Last Payment date equals Date Opened (potential inaccuracy)",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "minor",
    "fieldsImpacted": ["date_last_payment","date_opened"],
    "rule": {
      "all": [
        {"field":"date_last_payment","eq_field":"date_opened"}
      ]
    }
  },

  "LAST_PAYMENT_TOO_RECENT_ON_DEROG": {
    "violation": "Account marked derogatory but last payment is too recent",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "major",
    "fieldsImpacted": ["date_last_payment","payment_status"],
    "rule": {
      "all": [
        {"field":"payment_status","in":["60","90","120","180","CO"]},
        {"field":"date_last_payment","gt":"30"}
      ]
    }
  },

  "PAYMENT_HISTORY_AFTER_CLOSED": {
    "violation": "Payment history shows activity after closure date",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "major",
    "fieldsImpacted": ["payment_history","date_closed"],
    "rule": {
      "all": [
        {"field":"payment_history_date","gt_field":"date_closed"}
      ]
    }
  },

  "LAST_REPORTED_MISSING_ON_ACTIVE": {
    "violation": "Active account missing last reported date",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["last_reported"],
    "rule": {
      "all": [
        {"field":"account_status","in":["Open","Current"]},
        {"field":"last_reported","exists":false}
      ]
    }
  },

  "STUDENT_LOAN_DISBURSEMENT_CONFLICT": {
    "violation": "Student loan disbursement date conflicts with Date Opened",
    "target": "tradeline",
    "fcraSection": "§607(b)",
    "severity": "moderate",
    "fieldsImpacted": ["date_opened","first_disbursement_date"],
    "rule": {
      "all": [
        {"field":"account_type","contains":"Student"},
        {"field":"first_disbursement_date","lt_field":"date_opened"}
      ]
    }
  }
}

