<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Billing</title>
  <script src="https://cdn.tailwindcss.com"></script>
<script>
(() => {
  const themes = {
    purple:{accent:'#AF52DE',hover:'#9333EA',bg:'#AF52DE',
            glassBg:'rgba(255,255,255,0.4)',glassBrd:'rgba(255,255,255,0.25)'},
    blue:{accent:'#007AFF',hover:'#005BB5',bg:'#007AFF',
          glassBg:'rgba(255,255,255,0.4)',glassBrd:'rgba(255,255,255,0.25)'},
    green:{accent:'#34C759',hover:'#248A3D',bg:'#34C759',
           glassBg:'rgba(255,255,255,0.4)',glassBrd:'rgba(255,255,255,0.25)'}
    // â€¦keep the rest of your themes
  };
  const name = localStorage.getItem('theme') || 'purple';
  const t = themes[name] || themes.purple;
  const r = document.documentElement.style;
  r.setProperty('--accent', t.accent);
  r.setProperty('--accent-hover', t.hover);
  r.setProperty('--accent-bg', t.bg);
  r.setProperty('--glass-bg', t.glassBg);
  r.setProperty('--glass-brd', t.glassBrd);
  r.setProperty('--btn-text', '#fff');
  document.documentElement.style.visibility = 'hidden';
  document.addEventListener('DOMContentLoaded', () => {
    document.documentElement.style.visibility = '';
  });
})();
</script>
<link rel="stylesheet" href="/style.css">
</head>
<body>
<header id="host-nav" class="p-4">
  <div class="max-w-7xl mx-auto glass card nav-shell">
    <div class="nav-brand-row">
      <div class="text-xl font-semibold">Metro 2 CRM</div>
      <button id="navToggle" class="btn md:hidden" type="button" aria-expanded="false" aria-controls="primaryNav">
        <span>Menu</span>
        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
    <nav id="primaryNav" class="hidden flex-col gap-2 md:flex md:flex-row md:items-center md:gap-2" aria-label="Primary">
      <div id="primaryNavLinks" class="flex flex-col md:flex-row md:items-center gap-2 w-full md:w-auto">
        <a href="/dashboard" class="btn nav-btn">Dashboard</a>
        <a href="/clients" class="btn nav-btn">Clients</a>
        <a href="/leads" class="btn nav-btn">Leads</a>
        <a href="/schedule" class="btn nav-btn">Schedule</a>
        <a href="/billing" class="btn nav-btn">Billing</a>
        <div class="nav-dropdown" id="navSettings">
          <button type="button" id="navSettingsToggle" class="btn nav-btn flex items-center justify-between md:justify-center gap-2" aria-expanded="false" aria-haspopup="true">
            <span>Settings</span>
            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div id="navSettingsMenu" class="nav-dropdown-menu glass card p-2">
            <a id="navCompany" href="/my-company" class="btn text-sm">My Company</a>
            <a href="/letters" class="btn text-sm">Letter</a>
            <a href="/library" class="btn text-sm">Library</a>
            <a href="/workflows" class="btn text-sm">Workflows</a>
            <button id="btnInvite" class="btn text-sm" style="background: var(--green-bg);">Add Team Member</button>
          </div>
        </div>
        <a href="/tradelines" class="btn nav-btn">Tradelines</a>
        <button id="btnHelp" class="btn nav-btn" data-tip="Help (H)">Help</button>
        <div id="tierBadge" class="hidden sm:flex items-center gap-2 rounded-full bg-emerald-100 px-4 py-2 text-emerald-700 shadow-sm" title="You've started your journey.">
          <span class="text-xl">ðŸ“„</span>
          <span class="font-semibold text-sm">Rookie</span>
        </div>
      </div>
    </nav>
  </div>
</header>
<main class="max-w-7xl mx-auto p-4 space-y-6">
  <div id="noClient" class="glass card hidden">Select a client from the Clients page first. Selecciona un cliente en la pÃ¡gina de Clientes primero.</div>

  <div id="billingContent" class="space-y-6 hidden">
    <section class="glass card p-6 md:p-8 space-y-6">
      <div class="flex flex-col gap-6 md:flex-row md:items-start md:justify-between">
        <div class="space-y-4 max-w-2xl">
          <p class="text-xs font-semibold uppercase tracking-[0.4em] text-slate-500">Cashflow clarity Â· Claridad financiera</p>
          <div>
            <h1 class="text-3xl font-semibold text-slate-900">Billing &amp; Subscriptions</h1>
            <h2 class="text-lg text-slate-600">FacturaciÃ³n y suscripciones</h2>
          </div>
          <p class="text-sm text-slate-700 leading-relaxed">
            Keep every charge traceable for Metro-2 and FCRA compliance while giving clients premium payment experiences.
            MantÃ©n cada cargo trazable para el cumplimiento Metro-2 y FCRA mientras ofreces experiencias de pago premium.
          </p>
          <ul class="grid gap-2 text-sm text-slate-600 sm:grid-cols-2">
            <li class="flex items-start gap-2"><span class="mt-1 text-accent">â–¹</span><span>Send secure payment links within seconds.<br />EnvÃ­a enlaces de pago seguros en segundos.</span></li>
            <li class="flex items-start gap-2"><span class="mt-1 text-accent">â–¹</span><span>Track charge-offs vs. settlements cleanly.<br />Sigue cargos vs. acuerdos con claridad.</span></li>
            <li class="flex items-start gap-2"><span class="mt-1 text-accent">â–¹</span><span>Auto-remind clients ahead of due dates.<br />Automatiza recordatorios antes de la fecha lÃ­mite.</span></li>
            <li class="flex items-start gap-2"><span class="mt-1 text-accent">â–¹</span><span>Snapshot KPIs for finance + sales teams.<br />Visibiliza KPIs para finanzas y ventas.</span></li>
          </ul>
        </div>
        <div class="glass card border border-white/50 bg-white/70 p-5 shadow-xl shadow-slate-900/5 md:max-w-sm space-y-4">
          <div>
            <div class="text-sm font-semibold text-slate-700">Active invoices Â· Facturas activas</div>
            <div class="text-3xl font-bold text-slate-900" id="invoiceCount">0</div>
          </div>
          <div class="space-y-1 text-sm text-slate-600">
            <p>Consult â†’ Purchase target: 42%.</p>
            <p>Objetivo ConsultorÃ­a â†’ Compra: 42%.</p>
          </div>
          <button type="button" class="btn w-full justify-center py-3 text-sm font-semibold">
            Send payment link Â· Enviar enlace de pago
          </button>
          <p class="text-xs text-slate-500">Share via SMS or emailâ€”no SSN stored, only last4 on file. Comparte por SMS o email; jamÃ¡s almacenamos el SSN completo.</p>
        </div>
      </div>
      <div class="flex flex-wrap gap-3">
        <button type="button" class="btn px-4 py-2 text-sm font-semibold">Download CSV Â· Descargar CSV</button>
        <button type="button" class="btn px-4 py-2 text-sm font-semibold" style="background: var(--green-bg);">
          Offer one-time payoff Â· Ofrecer pago Ãºnico
        </button>
      </div>
    </section>

    <section class="grid gap-4 md:grid-cols-2 xl:grid-cols-4">
      <article class="glass card p-5 space-y-2">
        <p class="text-xs uppercase tracking-widest text-slate-500">Plan</p>
        <p class="text-xl font-semibold text-slate-900">Growth Suite Â· $297/mo</p>
        <p class="text-sm text-slate-600">Includes Metro-2 automation, dispute letter engine, and bilingual support.</p>
        <button type="button" class="btn w-fit px-4 py-2 text-xs font-semibold">View upgrades Â· Ver mejoras</button>
      </article>
      <article class="glass card p-5 space-y-2">
        <p class="text-xs uppercase tracking-widest text-slate-500">Outstanding</p>
        <p id="metricOutstanding" class="text-2xl font-semibold text-slate-900">$0.00</p>
        <p class="text-sm text-slate-600">Balance awaiting payment. Saldo pendiente de cobro.</p>
      </article>
      <article class="glass card p-5 space-y-2">
        <p class="text-xs uppercase tracking-widest text-slate-500">Next due Â· PrÃ³ximo vencimiento</p>
        <p id="metricNextDue" class="text-xl font-semibold text-slate-900">â€”</p>
        <p id="metricNextAmount" class="text-sm font-medium text-emerald-600">â€”</p>
        <p id="metricNextDesc" class="text-xs text-slate-500">No open invoices Â· No hay facturas abiertas.</p>
      </article>
      <article class="glass card p-5 space-y-2">
        <p class="text-xs uppercase tracking-widest text-slate-500">Collected YTD</p>
        <p id="metricCollected" class="text-2xl font-semibold text-slate-900">$0.00</p>
        <p class="text-sm text-slate-600">Closed revenue booked this year. Ingresos cerrados este aÃ±o.</p>
      </article>
    </section>

    <section class="glass card p-6 md:p-7 flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
      <div class="space-y-2">
        <p class="text-sm font-semibold text-slate-700">Autopay control Â· Cargo automÃ¡tico</p>
        <p id="autopayStatus" class="text-lg font-semibold text-slate-900">Autopay off Â· Cargo automÃ¡tico desactivado</p>
        <p id="autopayCopy" class="text-sm text-slate-600">Turn this on to draft recurring invoices and stay Metro-2 compliant. Activa esta opciÃ³n para automatizar facturas recurrentes con cumplimiento Metro-2.</p>
      </div>
      <div class="space-y-2">
        <label class="flex items-center gap-3">
          <input id="autopaySwitch" type="checkbox" class="h-5 w-5 rounded border-slate-300 text-emerald-500 focus:ring-emerald-500">
          <span id="autopaySwitchLabel" class="text-sm font-medium text-slate-700">Enable autopay Â· Activar cargo automÃ¡tico</span>
        </label>
        <p class="text-xs text-slate-500">Receipts email instantly. Los recibos se envÃ­an por email al instante.</p>
      </div>
    </section>

    <div class="grid gap-6 lg:grid-cols-3">
      <section class="glass card p-6 lg:col-span-2 space-y-6">
        <div class="flex flex-wrap items-center justify-between gap-4">
          <div>
            <h3 class="text-xl font-semibold text-slate-900">Invoice history</h3>
            <p class="text-sm text-slate-600">Monitor payments, disputes, and refunds. Supervisa pagos, disputas y reembolsos.</p>
          </div>
          <div class="flex flex-wrap gap-2 text-xs font-medium text-slate-600">
            <span class="badge badge-unpaid">Due soon Â· Vence pronto</span>
            <span class="badge badge-paid">Paid Â· Pagado</span>
          </div>
        </div>
        <div class="overflow-x-auto rounded-2xl border border-white/40">
          <table id="invoiceTable" class="invoice-table min-w-full divide-y divide-white/40 text-sm">
            <thead class="bg-white/60 text-left text-xs font-semibold uppercase tracking-widest text-slate-500">
              <tr>
                <th class="px-4 py-3">Description Â· DescripciÃ³n</th>
                <th class="px-4 py-3">Amount Â· Monto</th>
                <th class="px-4 py-3">Due Â· Vence</th>
                <th class="px-4 py-3">Status Â· Estado</th>
                <th class="px-4 py-3">Actions Â· Acciones</th>
              </tr>
            </thead>
            <tbody id="invoiceBody" class="bg-white/50"></tbody>
          </table>
        </div>
        <div id="invoiceEmpty" class="hidden rounded-xl border border-dashed border-slate-300/70 bg-white/60 p-6 text-sm text-slate-600">
          No invoices yet. Create your first invoice to trigger consult â†’ purchase tracking.
          AÃºn no hay facturas. Crea la primera factura para activar el seguimiento de consultorÃ­a â†’ compra.
        </div>
        <p class="text-xs text-slate-500">Compliance note: never promise guaranteed credit outcomes or timelines. Anota expectativas realistas en cada factura.</p>
      </section>

      <div class="space-y-6">
        <section class="glass card p-6 space-y-4">
          <div class="flex items-center justify-between gap-4">
            <div>
              <h3 class="text-lg font-semibold text-slate-900">Saved payment method</h3>
              <p class="text-sm text-slate-600">Visa ending 4242 Â· Updated Jun 14</p>
            </div>
            <span class="rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Tokenized</span>
          </div>
          <div class="rounded-xl bg-white/80 p-4 text-sm text-slate-700 shadow-sm">
            Apple Pay &amp; ACH ready. Use Stripe to refresh authorization.
            Apple Pay y ACH listos. Usa Stripe para refrescar la autorizaciÃ³n.
          </div>
          <button type="button" class="btn w-full justify-center py-3 text-sm font-semibold">Update card Â· Actualizar tarjeta</button>
        </section>

        <section class="glass card p-6 space-y-4">
          <h3 class="text-lg font-semibold text-slate-900">Quick add invoice Â· Crear factura rÃ¡pida</h3>
          <div class="space-y-3">
            <label class="flex flex-col gap-1 text-sm text-slate-700">
              <span>Description Â· DescripciÃ³n</span>
              <input id="invDesc" class="input" placeholder="Metro-2 audit retainer" />
            </label>
            <label class="flex flex-col gap-1 text-sm text-slate-700">
              <span>Amount Â· Monto</span>
              <input id="invAmount" type="number" step="0.01" class="input" placeholder="297.00" />
            </label>
            <label class="flex flex-col gap-1 text-sm text-slate-700">
              <span>Due date Â· Fecha lÃ­mite</span>
              <input id="invDue" type="date" class="input" />
            </label>
          </div>
          <button id="invAdd" type="button" class="btn w-full justify-center py-3 text-sm font-semibold">Add invoice Â· Crear factura</button>
          <p class="text-xs text-slate-500">We only store last4 + token. Solo almacenamos Ãºltimos 4 dÃ­gitos y token de pago.</p>
        </section>

        <section class="glass card border border-white/50 bg-white/70 p-6 space-y-4">
          <h3 class="text-lg font-semibold text-slate-900">Revenue accelerator Â· Acelerador de ingresos</h3>
          <p class="text-sm text-slate-600">Bundle a Metro-2 compliance review for $97 and boost AOV. Agrupa una revisiÃ³n de cumplimiento Metro-2 por $97 y aumenta el ticket promedio.</p>
          <button type="button" class="btn w-full justify-center py-3 text-sm font-semibold">Launch growth review Â· Lanzar revisiÃ³n</button>
          <p class="text-xs text-slate-500">KPI to watch: AOV &amp; Consult â†’ Purchase%. Mide Ticket Promedio y % Consulta â†’ Compra.</p>
        </section>
      </div>
    </div>
  </div>
</main>
<script type="module" src="/common.js"></script>
<script src="/hotkeys.js"></script>
<script src="/billing.js" type="module"></script>

</body>
</html>
