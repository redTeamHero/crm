<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title data-i18n="marketing.meta.title">Marketing</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/theme.js"></script>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
<header id="host-nav" class="p-4">
  <div class="max-w-7xl mx-auto glass card nav-shell">
    <div class="nav-brand-row">
      <div class="text-xl font-semibold">Metro 2 CRM</div>
      <button id="navToggle" class="btn md:hidden" type="button" aria-expanded="false" aria-controls="primaryNav">
        <span>Menu</span>
        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
    <nav id="primaryNav" class="hidden flex-col gap-2 md:flex md:flex-row md:items-center md:gap-2" aria-label="Primary">
      <div id="primaryNavLinks" class="flex flex-col md:flex-row md:items-center gap-2 w-full md:w-auto">
        <a href="/dashboard" class="btn nav-btn">Dashboard</a>
        <a href="/clients" class="btn nav-btn">Clients</a>
        <a href="/leads" class="btn nav-btn">Leads</a>
        <a href="/schedule" class="btn nav-btn">Schedule</a>
        <a href="/billing" class="btn nav-btn">Billing</a>
        <div class="nav-dropdown" id="navSettings">
          <button type="button" id="navSettingsToggle" class="btn nav-btn flex items-center justify-between md:justify-center gap-2" aria-expanded="false" aria-haspopup="true">
            <span>Settings</span>
            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div id="navSettingsMenu" class="nav-dropdown-menu glass card p-2">
            <a id="navCompany" href="/my-company" class="btn text-sm">My Company</a>
            <a href="/letters" class="btn text-sm">Letter</a>
            <a href="/library" class="btn text-sm">Library</a>
            <a href="/workflows" class="btn text-sm">Workflows</a>
            <button id="btnInvite" class="btn text-sm" style="background: var(--green-bg);">Add Team Member</button>
          </div>
        </div>
        <a href="/tradelines" class="btn nav-btn">Tradelines</a>
        <button id="btnHelp" class="btn nav-btn" data-tip="Help (H)">Help</button>
        <div id="tierBadge" class="hidden sm:flex items-center gap-2 rounded-full bg-emerald-100 px-4 py-2 text-emerald-700 shadow-sm" title="You've started your journey.">
          <span class="text-xl">üìÑ</span>
          <span class="font-semibold text-sm">Rookie</span>
        </div>
      </div>
    </nav>
  </div>
</header>
<main class="max-w-6xl mx-auto p-4 space-y-6">
  <header class="glass card p-6 space-y-3">
    <div class="flex items-center gap-3">
      <span class="text-3xl">üöÄ</span>
      <div>
        <h1 class="text-2xl font-bold" data-i18n="marketing.hero.title">Marketing Launchpad</h1>
        <p class="text-sm text-slate-600" data-i18n="marketing.hero.subtitle">Plan premium credit-repair journeys, nurture leads, and prep conversion-focused automations before you wire them into Twilio, SendGrid, or any integration.</p>
      </div>
    </div>
    <p class="text-xs text-slate-500" data-i18n="marketing.hero.tip">Tip: document every touchpoint to stay compliant, boost trust, and prime upsells. Once the backend hooks are live, these tiles can push payloads directly to your automation queue.</p>
  </header>

  <!-- SMS Campaign Builder -->
  <section aria-labelledby="sms-builder-heading" class="glass card p-6 space-y-6">
    <div class="flex flex-col gap-2">
      <div class="flex items-center gap-3">
        <span class="text-2xl">üì±</span>
        <div>
          <h2 id="sms-builder-heading" class="text-xl font-semibold" data-i18n="marketing.smsBuilder.heading">SMS Campaign Builder</h2>
          <p class="text-sm text-slate-600" data-i18n="marketing.smsBuilder.description">Craft compliant outreach, personalize with merge fields, and preview the mobile experience before launch.</p>
        </div>
      </div>
      <div class="flex flex-wrap gap-2 text-xs text-slate-500">
        <span class="chip bg-white/60" data-i18n="marketing.smsBuilder.kpi">Suggested KPI: Reply Rate</span>
        <span class="chip bg-white/60" data-i18n="marketing.smsBuilder.upsell">Upsell: SMS Concierge Follow-up</span>
        <span class="chip bg-white/60" data-i18n="marketing.smsBuilder.experiment">A/B Test: CTA ‚ÄúBook Call‚Äù vs ‚ÄúExplore your plan‚Äù</span>
      </div>
    </div>
    <div class="grid gap-6 lg:grid-cols-2">
      <form class="glass card bg-white/70 shadow-inner space-y-4" id="smsForm">
        <div class="flex flex-col gap-2">
          <label class="text-sm font-medium" for="smsCampaignName" data-i18n="marketing.smsBuilder.campaignName">Campaign Name</label>
          <input id="smsCampaignName" class="input" type="text" placeholder="Fall Promo Launch" data-i18n-placeholder="marketing.smsBuilder.campaignPlaceholder" />
        </div>
        <div class="flex flex-col gap-2">
          <label class="text-sm font-medium" for="smsSegment" data-i18n="marketing.smsBuilder.recipientLabel">Recipient Group</label>
          <select id="smsSegment" class="input">
            <option value="leads" data-i18n="marketing.smsBuilder.recipients.leads">All Leads</option>
            <option value="new-clients" data-i18n="marketing.smsBuilder.recipients.newClients">New Clients (‚â§30 days)</option>
            <option value="inactive" data-i18n="marketing.smsBuilder.recipients.inactive">Inactive Accounts (90+ days)</option>
            <option value="truckers" data-i18n="marketing.smsBuilder.recipients.truckers">Owner-Operators and Truckers</option>
          </select>
        </div>
        <div class="flex flex-col gap-2">
          <div class="flex items-center justify-between gap-2">
            <label class="text-sm font-medium" for="smsMessage" data-i18n="marketing.smsBuilder.messageLabel">Message</label>
            <div class="flex items-center gap-2 text-xs text-slate-500">
              <label class="sr-only" for="mergeFieldSelect" data-i18n="marketing.smsBuilder.insertMerge">Insert Merge Field</label>
              <select id="mergeFieldSelect" class="input text-xs py-1 px-2">
                <option value="" data-i18n="marketing.smsBuilder.personalize">+ Personalize</option>
                <option value="{{first_name}}">{{first_name}}</option>
                <option value="{{last_name}}">{{last_name}}</option>
                <option value="{{credit_score}}">{{credit_score}}</option>
                <option value="{{dispute_stage}}">{{dispute_stage}}</option>
                <option value="{{account_type}}">{{account_type}}</option>
              </select>
            </div>
          </div>
          <textarea id="smsMessage" class="input min-h-[140px]" placeholder="Hi {{first_name}}, we spotted a dispute update ready for review. Tap to confirm your next step." data-i18n-placeholder="marketing.smsBuilder.messagePlaceholder"></textarea>
          <div class="flex flex-wrap items-center justify-between gap-2 text-xs text-slate-500">
            <span><span data-i18n="marketing.smsBuilder.characterLabel">Character Count:</span> <span id="smsCharCount">0/160</span></span>
            <div class="flex items-center gap-1" aria-label="Quick merge fields">
              <button type="button" class="chip" data-token="{{first_name}}">{{first_name}}</button>
              <button type="button" class="chip" data-token="{{dispute_stage}}">{{dispute_stage}}</button>
              <button type="button" class="chip" data-token="{{cta_link}}">{{cta_link}}</button>
            </div>
          </div>
        </div>
        <div class="flex flex-wrap items-center gap-3">
          <button id="smsPreviewBtn" class="btn" type="button" data-i18n="marketing.smsBuilder.previewButton">Preview SMS</button>
          <button id="smsTestBtn" class="btn bg-slate-900" type="button" data-i18n="marketing.smsBuilder.sendTestButton">Send Test</button>
          <span class="text-xs text-slate-500" data-i18n="marketing.smsBuilder.guardrails">Guardrails: opt-out copy auto-appended, rate-limited when live.</span>
        </div>
      </form>
      <aside class="flex justify-center">
        <div class="relative w-[280px] max-w-full rounded-[30px] border border-slate-900/10 bg-slate-900 text-white shadow-[0_0_0_8px_rgba(255,255,255,0.2)]">
          <div class="absolute inset-x-12 top-3 h-6 rounded-full bg-black/50"></div>
          <div class="p-6 pt-14 space-y-4">
            <div class="text-sm text-slate-300" data-i18n="marketing.smsBuilder.previewBadge">Preview ‚Ä¢ Twilio Ready</div>
            <div class="rounded-2xl bg-gradient-to-br from-violet-600 to-fuchsia-500 p-4 text-sm leading-6" id="smsPreviewBubble">
              Hi Alex üëãüèª
              Revolv.AI spotted a Metro-2 update for your {{dispute_stage}}.
              Tap here to review ‚Üí https://go.revolv.ai/next
            </div>
            <div class="rounded-2xl border border-white/10 bg-white/5 p-3 text-[11px] text-slate-200" data-i18n="marketing.smsBuilder.previewNote">
              Personalization sample uses demo data. Final send will use live CRM fields.
            </div>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <!-- Email Template Builder -->
  <section aria-labelledby="email-builder-heading" class="glass card p-6 space-y-6">
    <div class="flex flex-col gap-2">
      <div class="flex items-center gap-3">
        <span class="text-2xl">üíå</span>
        <div>
          <h2 id="email-builder-heading" class="text-xl font-semibold" data-i18n="marketing.emailBuilder.heading">Email Template Designer</h2>
          <p class="text-sm text-slate-600" data-i18n="marketing.emailBuilder.description">Organize nurture flows, automate onboarding, and prep branded sends before you connect SendGrid or Postalytics.</p>
        </div>
      </div>
      <div class="flex flex-wrap items-center gap-2 text-xs text-slate-500">
        <span class="chip bg-white/60" data-i18n="marketing.emailBuilder.metricChip">Metric: Open ‚Üí Consult %</span>
        <span class="chip bg-white/60" data-i18n="marketing.emailBuilder.automationChip">Automation idea: 7-day roadmap drip</span>
        <span class="chip bg-white/60" data-i18n="marketing.emailBuilder.experimentChip">CTA Test: ‚ÄúSchedule Strategy Call‚Äù vs ‚ÄúExplore your plan‚Äù</span>
      </div>
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div class="flex items-center gap-2 text-sm">
          <button class="btn" id="btnAddTemplate" type="button" data-i18n="marketing.emailBuilder.newTemplate">New Template</button>
          <button class="btn bg-slate-900" id="btnImportHtml" type="button" data-i18n="marketing.emailBuilder.importHtml">Import HTML</button>
          <input class="hidden" id="htmlImportInput" type="file" accept=".html,text/html" aria-hidden="true" tabindex="-1" />
        </div>
        <div class="flex items-center gap-2 text-xs text-slate-500">
          <label class="sr-only" for="templateFilter" data-i18n="marketing.emailBuilder.filterLabel">Segment</label>
          <select id="templateFilter" class="input text-xs py-1 px-2">
            <option value="all" data-i18n="marketing.emailBuilder.filters.all">All Segments</option>
            <option value="b2c" data-i18n="marketing.emailBuilder.filters.b2c">B2C Consumers</option>
            <option value="b2b" data-i18n="marketing.emailBuilder.filters.b2b">B2B and Truckers</option>
            <option value="attorneys" data-i18n="marketing.emailBuilder.filters.attorneys">Attorneys and Referrals</option>
          </select>
          <span class="hidden md:inline" data-i18n="marketing.emailBuilder.filterHelper">Filter to prep tailored automations.</span>
        </div>
      </div>
    </div>
    <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-3" id="emailTemplateGrid">
      <p id="templatesEmpty" class="rounded-lg border border-dashed border-slate-300 bg-white/50 p-4 text-sm text-slate-500" data-i18n="marketing.emailBuilder.emptyState">Templates load from the backend. Use ‚ÄúNew Template‚Äù to save your first design.</p>
    </div>
  </section>

  <!-- Automation Control Center -->
  <section aria-labelledby="automation-center-heading" class="glass card p-6 space-y-6">
    <div class="flex items-center gap-3">
      <span class="text-2xl">ü§ñ</span>
      <div>
        <h2 id="automation-center-heading" class="text-xl font-semibold">Automation Control Center</h2>
        <p class="text-sm text-slate-600">Wire SMS templates, email sequences, and dispatch schedules to monetize automated follow-ups. Automate campaigns and flag vendors as ready.</p>
      </div>
    </div>

    <div class="grid gap-6 lg:grid-cols-2">
      <div class="space-y-4">
        <header class="flex flex-col gap-1">
          <h3 class="text-lg font-semibold">SMS Template Manager</h3>
          <p class="text-xs text-slate-500">Draft compliant copy, store via <code>POST /api/marketing/sms-templates</code>, upsell concierge follow-ups.</p>
        </header>
        <form id="smsTemplateForm" class="glass card bg-white/80 p-4 space-y-3">
          <div class="grid gap-2">
          <label class="text-sm font-medium" for="smsTemplateTitle">Template Title</label>
            <input id="smsTemplateTitle" name="title" class="input" placeholder="Re-activation Nurture" required />
          </div>
          <div class="grid gap-2">
            <label class="text-sm font-medium" for="smsTemplateSegment">Segment</label>
            <select id="smsTemplateSegment" name="segment" class="input">
              <option value="b2c">B2C Consumers</option>
              <option value="b2b">B2B Truckers</option>
              <option value="attorneys">Attorneys and Referrals</option>
              <option value="inactive">Inactive</option>
            </select>
          </div>
          <div class="grid gap-2">
            <label class="text-sm font-medium" for="smsTemplateBody">Message Body</label>
            <textarea id="smsTemplateBody" name="body" class="input h-32" placeholder="Hey {{first_name}}, your Metro-2 audit is ready. Schedule your consult here ‚Üí {{cta_link}}" required></textarea>
          </div>
            <div class="flex items-center justify-between text-xs text-slate-500">
              <span>Include opt-out language. Add ‚ÄúReply STOP‚Äù when this goes live.</span>
              <button class="btn" type="submit">Save Template</button>
            </div>
          <p id="smsTemplateStatus" class="hidden rounded-lg bg-emerald-100 px-3 py-2 text-xs text-emerald-700"></p>
        </form>
        <ul id="smsTemplateList" class="space-y-3 text-sm text-slate-600"></ul>
      </div>
      <div class="space-y-4">
        <header class="flex flex-col gap-1">
          <h3 class="text-lg font-semibold">Email Sequence Builder</h3>
          <p class="text-xs text-slate-500">Log nurture flows and push to <code>POST /api/marketing/email/sequences</code>. Document your value ladders.</p>
        </header>
        <form id="emailSequenceForm" class="glass card bg-white/80 p-4 space-y-3">
            <div class="grid gap-2">
              <label class="text-sm font-medium" for="sequenceTitle">Sequence Name</label>
              <input id="sequenceTitle" name="title" class="input" placeholder="7-Day Dispute Warm-Up" required />
            </div>
          <div class="grid gap-2">
            <label class="text-sm font-medium" for="sequenceDescription">Description</label>
            <textarea id="sequenceDescription" name="description" class="input h-20" placeholder="Outline journey, compliance reminders, NEPQ prompts."></textarea>
          </div>
          <div class="grid gap-2 md:grid-cols-2">
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="sequenceSegment">Segment</label>
              <select id="sequenceSegment" name="segment" class="input">
                <option value="b2c">B2C</option>
                <option value="b2b">B2B</option>
                <option value="attorneys">Attorneys</option>
              </select>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="sequenceFrequency">Frequency</label>
              <select id="sequenceFrequency" name="frequency" class="input">
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="biweekly">Bi-weekly</option>
              </select>
            </div>
          </div>
            <div class="space-y-2">
              <div class="flex items-center justify-between">
                <span class="text-sm font-medium">Steps</span>
                <button id="addSequenceStep" class="btn text-xs" type="button">Add Step</button>
              </div>
              <div id="sequenceSteps" class="space-y-3"></div>
              <p class="text-xs text-slate-500">Tip: tie at least one step to Stripe checkout or compliance doc delivery.</p>
            </div>
            <div class="flex items-center justify-between text-xs text-slate-500">
              <span>Preview before live send.</span>
              <button class="btn" type="submit">Save Sequence</button>
            </div>
          <p id="emailSequenceStatus" class="hidden rounded-lg bg-emerald-100 px-3 py-2 text-xs text-emerald-700"></p>
        </form>
        <ul id="emailSequenceList" class="space-y-3 text-sm text-slate-600"></ul>
      </div>
    </div>

    <div class="grid gap-6 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1fr)]">
      <div class="space-y-4">
        <header class="flex flex-col gap-1">
          <h3 class="text-lg font-semibold">Dispatch Scheduler</h3>
          <p class="text-xs text-slate-500">Queue campaigns via <code>POST /api/marketing/email/dispatches</code>. Perfect for consult reminders and upsell drops.</p>
        </header>
        <form id="dispatchForm" class="glass card bg-white/80 p-4 space-y-3">
          <div class="grid gap-2 md:grid-cols-2">
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="dispatchType">Target</label>
              <select id="dispatchType" name="targetType" class="input">
                <option value="template">Email Template</option>
                <option value="sequence">Email Sequence</option>
              </select>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="dispatchTarget">Asset</label>
              <select id="dispatchTarget" name="targetId" class="input"></select>
            </div>
          </div>
          <div class="grid gap-2 md:grid-cols-2">
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="dispatchFrequency">Cadence</label>
              <select id="dispatchFrequency" name="frequency" class="input">
                <option value="immediate">Immediate</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
              </select>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="dispatchSegment">Segment</label>
              <input id="dispatchSegment" name="segment" class="input" placeholder="b2c" />
            </div>
          </div>
          <div class="grid gap-2 md:grid-cols-2">
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="dispatchSchedule">Schedule</label>
              <input id="dispatchSchedule" name="scheduledFor" type="datetime-local" class="input" />
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-sm font-medium" for="dispatchAudience">Audience Count</label>
              <input id="dispatchAudience" name="audienceCount" type="number" min="0" class="input" placeholder="150" />
            </div>
          </div>
          <div class="grid gap-2">
              <label class="text-sm font-medium" for="dispatchNotes">Notes</label>
            <textarea id="dispatchNotes" name="notes" class="input h-20" placeholder="Record CTA, compliance disclaimers, premium promise."></textarea>
          </div>
            <div class="flex items-center justify-between text-xs text-slate-500">
              <span>Track consult set % and refunds to iterate.</span>
              <button class="btn" type="submit">Schedule</button>
            </div>
          <p id="dispatchStatus" class="hidden rounded-lg bg-emerald-100 px-3 py-2 text-xs text-emerald-700"></p>
        </form>
      </div>
      <div class="space-y-4">
          <header class="flex items-center justify-between">
            <h3 class="text-lg font-semibold">Upcoming Dispatches</h3>
            <span class="text-[10px] uppercase text-slate-400">Auto-refresh ready</span>
          </header>
        <ul id="dispatchList" class="space-y-3 text-sm text-slate-600"></ul>
      </div>
    </div>
  </section>

  <div id="templateEditorModal" class="fixed inset-0 z-40 hidden items-center justify-center bg-slate-900/60 p-4">
    <div class="glass card w-full max-w-3xl space-y-4 bg-white/90" role="dialog" aria-modal="true" aria-labelledby="templateEditorHeading">
      <header class="flex flex-wrap items-center justify-between gap-3">
        <div>
          <h3 id="templateEditorHeading" class="text-lg font-semibold" data-i18n="marketing.emailBuilder.editor.title">Email Template Editor</h3>
          <p class="text-xs text-slate-500" data-i18n="marketing.emailBuilder.editor.subtitle">Edit bilingual journeys, update CTA copy, and sync with automations.</p>
        </div>
        <div class="flex flex-wrap gap-2 text-xs">
          <button class="btn bg-slate-900" type="button" data-close-template-editor data-i18n="marketing.emailBuilder.editor.close">Close</button>
        </div>
      </header>
      <form id="templateEditorForm" class="space-y-4">
        <div class="grid gap-3 md:grid-cols-2">
          <div class="grid gap-2">
            <label class="text-sm font-medium" for="templateEditorTitle" data-i18n="marketing.emailBuilder.editor.titleLabel">Template Name / Nombre</label>
            <input id="templateEditorTitle" name="title" class="input" placeholder="Onboarding Touchpoint" required />
          </div>
          <div class="grid gap-2">
            <label class="text-sm font-medium" for="templateEditorSegment" data-i18n="marketing.emailBuilder.editor.segmentLabel">Segment</label>
            <select id="templateEditorSegment" name="segment" class="input">
              <option value="b2c">B2C ‚Ä¢ Consumidores</option>
              <option value="b2b">B2B ‚Ä¢ Truckers</option>
              <option value="attorneys">Attorneys / Abogados</option>
              <option value="inactive">Inactive</option>
            </select>
          </div>
        </div>
        <div class="grid gap-3 md:grid-cols-[minmax(0,1fr)_minmax(0,0.7fr)]">
          <div class="grid gap-3">
            <div class="grid gap-2">
              <label class="text-sm font-medium" for="templateEditorBadge" data-i18n="marketing.emailBuilder.editor.badgeLabel">Badge</label>
              <input id="templateEditorBadge" name="badge" class="input" placeholder="EN/ES" />
            </div>
            <div class="grid gap-2">
              <label class="text-sm font-medium" for="templateEditorDescription" data-i18n="marketing.emailBuilder.editor.descriptionLabel">Description / Descripci√≥n</label>
              <textarea id="templateEditorDescription" name="description" class="input h-24" placeholder="Outline trust builders, CTA, bilingual promise."></textarea>
            </div>
            <div class="grid gap-2">
              <label class="text-sm font-medium" for="templateEditorHtml" data-i18n="marketing.emailBuilder.editor.htmlLabel">HTML Content</label>
              <textarea id="templateEditorHtml" name="html" class="input min-h-[200px] font-mono text-xs" placeholder="<h1>Bienvenido</h1>"></textarea>
            </div>
          </div>
          <aside class="flex flex-col gap-2 rounded-xl border border-dashed border-slate-300 bg-white/70 p-4">
            <div class="flex items-center justify-between text-xs text-slate-500">
              <span data-i18n="marketing.emailBuilder.editor.previewLabel">Live Preview ‚Ä¢ Vista previa</span>
              <span id="templateEditorMeta" class="text-[10px] uppercase"></span>
            </div>
            <div id="templateEditorPreview" class="min-h-[240px] overflow-auto rounded-lg bg-white p-3 text-sm text-slate-700 shadow-inner"></div>
            <p class="text-[11px] text-slate-500" data-i18n="marketing.emailBuilder.editor.previewHint">Merge fields render with sample data. Final send pulls CRM values.</p>
          </aside>
        </div>
        <div class="flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500">
          <span data-i18n="marketing.emailBuilder.editor.guardrail">No promises of guaranteed results. Track consult conversion % and Stripe upsell.</span>
          <div class="flex flex-wrap gap-2">
            <button class="btn" type="submit" data-i18n="marketing.emailBuilder.editor.save">Save Template / Guardar</button>
            <button class="btn" type="button" data-close-template-editor data-i18n="marketing.emailBuilder.editor.cancel">Cancel</button>
          </div>
        </div>
        <p id="templateEditorStatus" class="hidden rounded-lg px-3 py-2 text-xs"></p>
      </form>
    </div>
  </div>

  <!-- Campaign Analytics Preview -->
  <section aria-labelledby="campaign-dashboard-heading" class="glass card p-6 space-y-6">
    <div class="flex items-center gap-3">
      <span class="text-2xl">üìä</span>
      <div>
        <h2 id="campaign-dashboard-heading" class="text-xl font-semibold" data-i18n="marketing.campaignDashboard.heading">Campaign Dashboard Preview</h2>
        <p class="text-sm text-slate-600" data-i18n="marketing.campaignDashboard.description">Visual placeholders ready to display Twilio/SendGrid metrics, pipeline revenue, and compliance alerts.</p>
      </div>
    </div>
    <div class="grid gap-4 md:grid-cols-[minmax(0,2fr)_minmax(0,1fr)]">
      <section class="space-y-4">
        <header class="flex items-center justify-between">
          <h3 class="text-lg font-semibold" data-i18n="marketing.campaignDashboard.recentCampaigns">Recent Campaigns</h3>
          <button class="btn" type="button" data-i18n="marketing.campaignDashboard.exportCsv">Export CSV</button>
        </header>
        <div class="space-y-3" id="campaignList">
          <article class="glass card bg-white/70 space-y-2" data-status="scheduled">
            <div class="flex items-center justify-between text-sm">
              <span class="font-semibold" data-i18n="marketing.campaignDashboard.cards.newYear.title">New Year Credit Boost</span>
              <span class="chip" data-i18n="marketing.campaignDashboard.statuses.scheduled">Scheduled</span>
            </div>
            <p class="text-xs text-slate-500" data-i18n="marketing.campaignDashboard.cards.newYear.body">Next touch: Jan 3 ‚Ä¢ Segment: Inactive Accounts ‚Ä¢ KPI target: 18% consult rate.</p>
            <div class="h-2 w-full overflow-hidden rounded-full bg-slate-200">
              <div class="h-full rounded-full bg-gradient-to-r from-violet-500 to-fuchsia-500" style="width:65%"></div>
            </div>
          </article>
          <article class="glass card bg-white/70 space-y-2" data-status="completed">
            <div class="flex items-center justify-between text-sm">
              <span class="font-semibold" data-i18n="marketing.campaignDashboard.cards.trucker.title">Trucker Safety + Credit Webinar</span>
              <span class="chip" data-i18n="marketing.campaignDashboard.statuses.completed">Completed</span>
            </div>
            <p class="text-xs text-slate-500" data-i18n="marketing.campaignDashboard.cards.trucker.body">Result: 24 booked consults ‚Ä¢ Upsell opportunity: Fleet compliance retainer.</p>
            <div class="h-2 w-full overflow-hidden rounded-full bg-slate-200">
              <div class="h-full rounded-full bg-gradient-to-r from-emerald-500 to-teal-500" style="width:92%"></div>
            </div>
          </article>
          <article class="glass card bg-white/70 space-y-2" data-status="draft">
            <div class="flex items-center justify-between text-sm">
              <span class="font-semibold" data-i18n="marketing.campaignDashboard.cards.scoreDrop.title">Score Drop Alert</span>
              <span class="chip" data-i18n="marketing.campaignDashboard.statuses.draft">Draft</span>
            </div>
            <p class="text-xs text-slate-500" data-i18n="marketing.campaignDashboard.cards.scoreDrop.body">Set webhook to Metro-2 anomaly detector ‚Ä¢ CTA: Schedule dispute strategy.</p>
            <div class="h-2 w-full overflow-hidden rounded-full bg-slate-200">
              <div class="h-full rounded-full bg-gradient-to-r from-sky-500 to-indigo-500" style="width:40%"></div>
            </div>
          </article>
        </div>
      </section>
      <aside class="space-y-4">
        <div class="glass card bg-white/80 p-4 space-y-3">
          <div class="flex items-center justify-between">
            <h3 class="text-base font-semibold" data-i18n="marketing.campaignDashboard.metrics.heading">Metrics Placeholder</h3>
            <span class="text-xs text-slate-500" data-i18n="marketing.campaignDashboard.metrics.badge">API ready</span>
          </div>
          <div class="h-36 rounded-xl border border-dashed border-slate-300 bg-white/60 flex flex-col items-center justify-center text-xs text-slate-400" data-i18n-html="marketing.campaignDashboard.metrics.placeholder">
            <span>Drop chart.js or Recharts here.</span>
            <span>Map open %, click %, revenue per send.</span>
          </div>
          <ul class="space-y-2 text-xs text-slate-500">
            <li data-i18n="marketing.campaignDashboard.metrics.bullets.track">‚Ä¢ Track: Lead ‚Üí Consult %, Consult ‚Üí Paid %, Refund %</li>
            <li data-i18n="marketing.campaignDashboard.metrics.bullets.alerts">‚Ä¢ Alerts: Opt-out spikes, deliverability drops</li>
            <li data-i18n="marketing.campaignDashboard.metrics.bullets.next">‚Ä¢ Next: Slack webhook for at-risk campaigns</li>
          </ul>
        </div>
        <div class="glass card bg-white/80 p-4 space-y-3">
          <h3 class="text-base font-semibold" data-i18n="marketing.campaignDashboard.experiments.heading">Experiments Queue</h3>
          <ul class="space-y-2 text-xs text-slate-500" id="experimentIdeas">
            <li data-i18n="marketing.campaignDashboard.experiments.item1">1Ô∏è‚É£ Pricing anchor: ‚Äú$49 Strategy Session‚Äù vs ‚Äú$0 Discovery‚Äù</li>
            <li data-i18n="marketing.campaignDashboard.experiments.item2">2Ô∏è‚É£ CTA microcopy: ‚ÄúStart audit‚Äù vs ‚ÄúStart your audit‚Äù</li>
            <li data-i18n="marketing.campaignDashboard.experiments.item3">3Ô∏è‚É£ Social proof position: testimonials vs score visualizer</li>
          </ul>
          <button class="btn" id="btnAddExperiment" type="button" data-i18n="marketing.campaignDashboard.experiments.logButton">Log Hypothesis</button>
        </div>
      </aside>
    </div>
  </section>

  <section aria-labelledby="integration-checklist-heading" class="glass card p-6 space-y-6">
    <div class="flex items-center gap-3">
      <span class="text-2xl">üß©</span>
      <div>
        <h2 id="integration-checklist-heading" class="text-xl font-semibold" data-i18n="marketing.integration.heading">Integration Checklist</h2>
        <p class="text-sm text-slate-600" data-i18n="marketing.integration.description">Wire this UI to Twilio, SendGrid, and other services without losing compliance.</p>
      </div>
    </div>
    <div class="grid gap-6 lg:grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)]">
      <div class="space-y-4">
        <h3 class="text-base font-semibold" data-i18n="marketing.integration.stepsTitle">Steps to Activate</h3>
        <ol class="list-decimal list-inside space-y-2 text-sm text-slate-600" id="integrationSteps">
          <li data-i18n-html="marketing.integration.steps.collect">Collect API keys and SIDs; store them in <code>.env</code> or Settings ‚Üí Integrations.</li>
          <li data-i18n-html="marketing.integration.steps.providers">Call <code>PATCH /api/marketing/providers/:id</code> to mark providers as <span class="font-semibold">ready</span>.</li>
          <li data-i18n-html="marketing.integration.steps.tests">Trigger <code>POST /api/marketing/tests</code> from ‚ÄúSend Test‚Äù to validate payloads.</li>
          <li data-i18n="marketing.integration.steps.worker">Connect a worker that consumes the queue and triggers Twilio/SendGrid with logs.</li>
        </ol>
        <div class="rounded-xl bg-slate-900 text-white p-4 space-y-2 text-xs">
          <div class="flex items-center justify-between text-sm">
            <span class="font-semibold" data-i18n="marketing.integration.curl.heading">cURL Smoke Test</span>
            <span class="uppercase tracking-wide text-[10px] text-violet-200" data-i18n="marketing.integration.curl.badge">Dev only</span>
          </div>
          <pre class="whitespace-pre-wrap break-words text-[11px] leading-5"><code id="curlExample" data-i18n="marketing.integration.curl.command">curl -X POST "$HOST/api/marketing/tests" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"channel":"sms","recipient":"+15125550199","smsPreview":"Hi {{first_name}}, your audit is ready."}'</code></pre>
        </div>
      </div>
      <div class="space-y-4">
        <div class="glass card bg-white/80 p-4 space-y-3">
          <div class="flex items-center justify-between">
            <h3 class="text-base font-semibold" data-i18n="marketing.integration.queue.heading">Queued Test Sends</h3>
            <button class="btn text-xs" id="refreshQueueBtn" type="button" data-i18n="marketing.integration.queue.refresh">Refresh</button>
          </div>
          <ul id="testQueueList" class="space-y-2 text-xs text-slate-600">
            <li class="rounded-lg border border-dashed border-slate-300 bg-white/50 p-3" data-i18n="marketing.integration.queue.empty">Run ‚ÄúSend Test‚Äù to see items here.</li>
          </ul>
        </div>
        <div class="glass card bg-white/80 p-4 space-y-3">
          <div class="flex items-center justify-between">
            <h3 class="text-base font-semibold" data-i18n="marketing.integration.providers.heading">Provider Status</h3>
            <span class="text-[10px] uppercase text-slate-400" data-i18n="marketing.integration.providers.badge">Live sync</span>
          </div>
          <p id="providerStatusStatus" class="hidden rounded-lg bg-emerald-100 px-3 py-2 text-xs text-emerald-700"></p>
          <ul id="providerStatusList" class="space-y-2 text-xs text-slate-600">
            <li class="rounded-lg border border-dashed border-slate-300 bg-white/50 p-3" data-i18n="marketing.integration.providers.empty">Use the API to register Twilio/SendGrid credentials.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

</main>

<div id="testModal" class="fixed inset-0 z-40 hidden items-center justify-center bg-slate-900/60 p-4">
  <div class="glass card max-w-md w-full space-y-4 bg-white/90" role="dialog" aria-modal="true" aria-labelledby="testModalTitle">
    <div class="flex items-center justify-between">
      <div>
        <h3 id="testModalTitle" class="text-lg font-semibold" data-i18n="marketing.testModal.title">Send Test Message</h3>
        <p class="text-xs text-slate-500" data-i18n="marketing.testModal.subtitle">Simulate a Twilio/SendGrid call. No live sends.</p>
      </div>
      <button class="btn bg-slate-900" type="button" data-close-test data-i18n="marketing.testModal.close">Close</button>
    </div>
    <form class="space-y-3" id="testForm">
      <div class="flex flex-col gap-2">
        <label class="text-sm font-medium" for="testChannel" data-i18n="marketing.testModal.channelLabel">Channel</label>
        <select id="testChannel" name="testChannel" class="input">
          <option value="sms" data-i18n="marketing.testModal.channelOptions.sms">SMS</option>
          <option value="email" data-i18n="marketing.testModal.channelOptions.email">Email</option>
        </select>
      </div>
      <div class="flex flex-col gap-2">
        <label class="text-sm font-medium" for="testRecipient" data-i18n="marketing.testModal.recipientLabel">Send To</label>
        <input id="testRecipient" name="testRecipient" class="input" type="text" placeholder="+1 512 555 0199 or demo@revolv.ai" data-i18n-placeholder="marketing.testModal.recipientPlaceholder" required />
      </div>
      <div class="flex flex-col gap-2">
        <label class="text-sm font-medium" for="testNotes" data-i18n="marketing.testModal.notesLabel">Notes</label>
        <textarea id="testNotes" name="testNotes" class="input" rows="3" placeholder="Log what you‚Äôre validating: tone, CTA, render checks." data-i18n-placeholder="marketing.testModal.notesPlaceholder"></textarea>
      </div>
      <div class="flex items-center justify-between text-xs text-slate-500">
        <span data-i18n="marketing.testModal.footerHint">Preview payload is queued via the marketing API for QA.</span>
        <button class="btn" type="submit" data-i18n="marketing.testModal.queueButton">Queue Test</button>
      </div>
      <p id="testStatus" class="hidden rounded-lg bg-emerald-100 px-3 py-2 text-xs text-emerald-700" data-i18n="marketing.testModal.success">Queued via marketing API ‚Äî list updates below.</p>
    </form>
  </div>
</div>
<script type="module" src="/common.js"></script>
<script type="module" src="/marketing.js"></script>
</body>
</html>
