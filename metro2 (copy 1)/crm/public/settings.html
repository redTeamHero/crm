<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Settings</title>
  <script src="https://cdn.tailwindcss.com"></script>
<script src="/theme.js"></script>
<link rel="stylesheet" href="/style.css">
</head>
<body>
<header id="host-nav" class="p-4">
  <div class="max-w-7xl mx-auto glass card nav-shell">
    <div class="nav-brand-row">
      <div class="text-xl font-semibold">Metro 2 CRM</div>
      <button id="navToggle" class="btn md:hidden" type="button" aria-expanded="false" aria-controls="primaryNav">
        <span>Menu</span>
        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
    <nav id="primaryNav" class="hidden flex-col gap-2 md:flex md:flex-row md:items-center md:gap-2" aria-label="Primary">
      <div id="primaryNavLinks" class="flex flex-col md:flex-row md:items-center gap-2 w-full md:w-auto">
        <a href="/dashboard" class="btn nav-btn">Dashboard</a>
        <a href="/clients" class="btn nav-btn">Clients</a>
        <a href="/leads" class="btn nav-btn">Leads</a>
        <div class="nav-dropdown" id="navMarketing">
          <button type="button" id="navMarketingToggle" class="btn nav-btn flex items-center justify-between md:justify-center gap-2" aria-expanded="false" aria-haspopup="true">
            <span data-i18n="nav.marketing">Marketing</span>
            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div id="navMarketingMenu" class="nav-dropdown-menu glass card p-2">
            <a href="/marketing/sms" class="btn text-sm" data-i18n="nav.marketingSms">Marketing â€¢ SMS / Mensajes</a>
            <a href="/marketing/email" class="btn text-sm" data-i18n="nav.marketingEmail">Marketing â€¢ Email / Correo</a>
          </div>
        </div>
        <a href="/schedule" class="btn nav-btn">Schedule</a>
        <a href="/billing" class="btn nav-btn">Billing</a>
        <div class="nav-dropdown" id="navSettings">
          <button type="button" id="navSettingsToggle" class="btn nav-btn flex items-center justify-between md:justify-center gap-2" aria-expanded="false" aria-haspopup="true">
            <span>Settings</span>
            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div id="navSettingsMenu" class="nav-dropdown-menu glass card p-2">
            <a id="navCompany" href="/my-company" class="btn text-sm">My Company</a>
            <a href="/letters" class="btn text-sm">Letter</a>
            <a href="/library" class="btn text-sm">Library</a>
            <a href="/settings#api-integrations" class="btn text-sm">APIs</a>
            <a href="/workflows" class="btn text-sm">Workflows</a>
            <button id="btnInvite" class="btn text-sm" style="background: var(--green-bg);">Add Team Member</button>
          </div>
        </div>
        <a href="/tradelines" class="btn nav-btn">Tradelines</a>
        <button id="btnHelp" class="btn nav-btn" data-tip="Help (H)">Help</button>
        <div id="tierBadge" class="hidden sm:flex items-center gap-2 rounded-full bg-emerald-100 px-4 py-2 text-emerald-700 shadow-sm" title="You've started your journey.">
          <span class="text-xl">ðŸ“„</span>
          <span class="font-semibold text-sm">Rookie</span>
        </div>
      </div>
    </nav>
  </div>
</header>
<main class="max-w-3xl mx-auto p-4 space-y-4">
  <h1 class="text-2xl font-bold">Settings</h1>

  <div id="adminPanel" class="glass card space-y-3 hidden">
    <div class="space-y-1">
      <div class="font-medium" id="api-integrations">API Integrations</div>
      <p class="text-xs text-gray-600">Centralize the keys for Stripe, Google Calendar, breach monitoring, and other services powering your workflow.</p>
    </div>
    <input id="hibpKey" class="w-full border rounded px-2 py-1 text-sm" placeholder="HIBP API Key" />
    <input id="rssFeedUrl" class="w-full border rounded px-2 py-1 text-sm" placeholder="RSS Feed URL" />
    <input id="gcalToken" class="w-full border rounded px-2 py-1 text-sm" placeholder="Google Calendar Token" />
    <input id="gcalId" class="w-full border rounded px-2 py-1 text-sm" placeholder="Google Calendar ID" />
    <input id="stripeKey" class="w-full border rounded px-2 py-1 text-sm" placeholder="Stripe API Key" />

    <div class="space-y-2 pt-2 border-t border-white/10">
      <div class="font-medium">Marketing API</div>
      <p class="text-xs text-gray-600">Expose these values to workers processing <code class="font-mono text-[10px]">/api/marketing</code> queues.</p>
      <input id="marketingApiBaseUrl" class="w-full border rounded px-2 py-1 text-sm" placeholder="Marketing API Base URL" />
      <input id="marketingApiKey" class="w-full border rounded px-2 py-1 text-sm" placeholder="Marketing API Key / Token" />
    </div>

    <div class="space-y-2 pt-2 border-t border-white/10">
      <div class="font-medium">Certified Mail</div>
      <p class="text-xs text-gray-600">SimpleCertifiedMail key for dispute letters mailed via USPS.</p>
      <input id="sendCertifiedMailKey" class="w-full border rounded px-2 py-1 text-sm" placeholder="SimpleCertifiedMail API Key" />
    </div>

    <div class="space-y-2 pt-2 border-t border-white/10">
      <div class="font-medium">Gmail API</div>
      <p class="text-xs text-gray-600">Use OAuth credentials to pipe support replies and transactional sends through Gmail.</p>
      <input id="gmailClientId" class="w-full border rounded px-2 py-1 text-sm" placeholder="Gmail Client ID" />
      <input id="gmailClientSecret" class="w-full border rounded px-2 py-1 text-sm" placeholder="Gmail Client Secret" />
      <input id="gmailRefreshToken" class="w-full border rounded px-2 py-1 text-sm" placeholder="Gmail Refresh Token" />
    </div>

    <div class="space-y-2 pt-2 border-t border-white/10">
      <details id="clientPortalDetails" class="group rounded-lg border border-white/10 bg-white/5 p-3" open>
        <summary class="flex items-center justify-between cursor-pointer">
          <span class="font-medium">Client Portal â€¢ Portal del Cliente</span>
          <svg class="h-4 w-4 transition-transform group-open:rotate-180" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </summary>
        <div class="mt-3 space-y-3 text-sm">
          <p class="text-xs text-gray-600">Brand the client portal with your logo, colors, and bilingual copy. Toggle sections to match the services you deliver.</p>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="creditScore" checked /> Credit Score / Puntaje de CrÃ©dito</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="negativeItems" checked /> Negative Items / Elementos Negativos</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="reportSnapshot" checked /> Report Snapshot / Resumen</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="milestones" checked /> Milestones / Metas</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="team" checked /> Team / Equipo</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="news" checked /> News / Noticias</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="debtCalc" checked /> Debt Tools / Calculadora</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="messages" checked /> Messages / Mensajes</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="education" checked /> Education / EducaciÃ³n</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="documents" checked /> Documents / Documentos</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="mail" checked /> Mail / Correo</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="payments" checked /> Payments / Pagos</label>
            <label class="flex items-center gap-2"><input type="checkbox" class="form-checkbox" data-portal-module="uploads" checked /> Uploads / Cargas</label>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
            <label class="block space-y-1">
              <span class="text-xs uppercase tracking-wide text-gray-500">Background Color (Hex) / Color de Fondo</span>
              <input id="portalBackgroundColor" class="w-full border rounded px-2 py-1 text-sm" placeholder="#0f172a" />
              <span class="text-[11px] text-gray-500">Leave blank to keep the animated gradient.</span>
            </label>
            <label class="block space-y-1">
              <span class="text-xs uppercase tracking-wide text-gray-500">Logo URL</span>
              <input id="portalLogoUrl" class="w-full border rounded px-2 py-1 text-sm" placeholder="https://cdn.yourbrand.com/logo.png" />
              <span class="text-[11px] text-gray-500">PNG/SVG recommended, 160Ã—160px, HTTPS or relative path.</span>
            </label>
            <label class="block space-y-1 sm:col-span-2">
              <span class="text-xs uppercase tracking-wide text-gray-500">Headline (English)</span>
              <input id="portalTaglinePrimary" class="w-full border rounded px-2 py-1 text-sm" placeholder="Track disputes, uploads, and approvals in one place." />
            </label>
            <label class="block space-y-1 sm:col-span-2">
              <span class="text-xs uppercase tracking-wide text-gray-500">Headline (Spanish)</span>
              <input id="portalTaglineSecondary" class="w-full border rounded px-2 py-1 text-sm" placeholder="Sigue tus disputas, cargas y aprobaciones en un solo lugar." />
            </label>
          </div>

          <div class="flex flex-wrap gap-2">
            <button type="button" id="portalThemeReset" class="btn text-xs">Reset to Defaults</button>
          </div>
        </div>
      </details>
    </div>

    <div class="border-t border-white/10 pt-3 space-y-2">
      <div class="font-medium">Environment Overrides</div>
      <p class="text-xs text-gray-600">Store API keys & tokens for integrations. Values are saved in the local CRM database and synced with the active server.</p>
      <p class="text-xs text-gray-500">Use uppercase letters, numbers, and underscores for the key.</p>
      <div id="envList" class="space-y-2 text-sm"></div>
      <button id="addEnvRow" type="button" class="btn text-xs">Add Variable</button>
    </div>

    <button id="saveSettings" class="btn text-sm">Save</button>
    <div id="saveMsg" class="text-sm muted hidden">Saved!</div>
  </div>

  <div id="userManager" class="glass card space-y-2 hidden">
    <div class="font-medium">User Permissions</div>
    <div id="userList" class="space-y-2 text-sm"></div>
  </div>

  <div id="hotkeyPanel" class="glass card space-y-2">
    <div class="font-medium">Keyboard Shortcuts</div>
    <div class="grid grid-cols-2 gap-2 text-sm">
      <label class="flex items-center gap-2">Help <input id="hotkeyHelp" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">New Consumer <input id="hotkeyNewConsumer" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">Upload <input id="hotkeyUpload" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">Edit Consumer <input id="hotkeyEditConsumer" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">Generate <input id="hotkeyGenerate" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">Remove Tradeline <input id="hotkeyRemove" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">Mode: Breach <input id="hotkeyModeBreach" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">Mode: Assault <input id="hotkeyModeAssault" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
      <label class="flex items-center gap-2">Mode: Identity <input id="hotkeyModeIdentity" class="w-12 border rounded px-2 py-1 text-sm" maxlength="1" /></label>
    </div>
    <button id="saveHotkeys" class="btn text-sm">Save Hotkeys</button>
    <div id="hotkeyMsg" class="text-sm muted hidden">Saved!</div>
  </div>
</main>
<script type="module" src="/common.js"></script>
<script src="/hotkeys.js"></script>
<script src="/settings.js"></script>
</body>
</html>

